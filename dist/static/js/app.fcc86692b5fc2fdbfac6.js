webpackJsonp([1],{NHnr:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("7+uW"),i={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]},o=s("VU/8")({name:"App"},i,!1,null,null,null).exports,n=s("/ocq"),r=s("kxiW"),l=s.n(r),c={data:()=>({user:null,lat:0,lng:0,watchPositionId:null}),mounted(){l.a.auth().onAuthStateChanged(t=>{this.user=t})},methods:{startLocationUpdates(){var t=new google.maps.Map(this.$refs.map,{zoom:15,mapTypeId:google.maps.MapTypeId.ROADMAP});new google.maps.Point(15,30);const e={path:google.maps.SymbolPath.CIRCLE,scale:8,strokeColor:"#393"};var s=new google.maps.Marker({map:t,icon:e});this.watchPositionId=navigator.geolocation.watchPosition(e=>{this.lat=e.coords.latitude,this.lng=e.coords.longitude,t.setCenter(new google.maps.LatLng(this.lat,this.lng)),s.setPosition(new google.maps.LatLng(this.lat,this.lng)),this.updateLocation(this.lat,this.lng)},t=>{console.log(t.message)})},stopLocationUpdates(){navigator.geolocation.clearWatch(this.watchPositionId)},signOutButtonPressed(){l.a.auth().signOut().then(t=>{this.$router.push({name:"Signin"})}).catch(t=>{console.log(t.message)})},updateLocation(t,e){l.a.firestore().collection("users").doc(this.user.uid).set({lat:t,lng:e,active:!0},{merge:!0})}}},u={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"driver-view"},[s("section",{staticClass:"top-bar"},[t.user?s("div",[t._v(t._s(t.user.email))]):t._e(),t._v(" "),s("div",[t._v("Driver")]),t._v(" "),s("button",{staticClass:"ui button red",on:{click:t.signOutButtonPressed}},[t._v("Signout")])]),t._v(" "),s("section",{ref:"map",staticClass:"map"}),t._v(" "),s("section",{staticClass:"bottom-bar"},[s("div",{staticClass:"latLngLabel"},[t._v(t._s(t.lat)+", "+t._s(t.lng))]),t._v(" "),s("button",{staticClass:"ui button green",on:{click:t.startLocationUpdates}},[s("i",{staticClass:"circle dot outline icon large"}),t._v("\n      Start Location\n    ")]),t._v(" "),s("button",{staticClass:"ui button red",on:{click:t.stopLocationUpdates}},[s("i",{staticClass:"circle dot outline icon large"}),t._v("\n      Stop Location\n    ")])])])},staticRenderFns:[]};var d=s("VU/8")(c,u,!1,function(t){s("NxZs")},null,null).exports,p={data:()=>({email:"",password:""}),methods:{loginButtonPressed(){l.a.auth().signInWithEmailAndPassword(this.email,this.password).then(t=>{console.log("user is singed in ")}).catch(t=>{console.log(t.message)})}}},m={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{staticClass:"ui centered grid",staticStyle:{"margin-top":"30px"}},[s("div",{staticClass:"column",staticStyle:{"max-width":"450px"}},[s("form",{staticClass:"ui segment large form"},[s("div",{staticClass:"ui segment"},[s("div",{staticClass:"field"},[s("div",{staticClass:"ui left icon input large"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.email,expression:"email"}],attrs:{type:"text",placeholder:"Enter your email"},domProps:{value:t.email},on:{input:function(e){e.target.composing||(t.email=e.target.value)}}}),t._v(" "),s("i",{staticClass:"ui icon user"})])]),t._v(" "),s("div",{staticClass:"field"},[s("div",{staticClass:"ui left icon input large"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],attrs:{type:"password",placeholder:"Enter your password"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}}),t._v(" "),s("i",{staticClass:"ui icon key"})])]),t._v(" "),s("button",{staticClass:"ui button fluid large red",on:{click:t.loginButtonPressed}},[t._v("Log in")])]),t._v(" "),s("router-link",{staticClass:"ui button basic",attrs:{to:{name:"SignUp"},tag:"a"}},[t._v("Sign up")])],1)])])},staticRenderFns:[]},g=s("VU/8")(p,m,!1,null,null,null).exports,h={data:()=>({email:"",password:""}),mounted(){},methods:{signUpButtonPressed(){l.a.auth().createUserWithEmailAndPassword(this.email,this.password).then(t=>{this.addUserToDB(t)}).catch(t=>{this.error=t.message})},async addUserToDB({user:t}){try{const e=l.a.firestore();_=await e.collection("users").doc(t.uid).set({email:t.email,active:!1}),this.$router.push({name:"Driver"})}catch(t){console.log(t.message)}}}},v={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{staticClass:"ui centered grid",staticStyle:{"margin-top":"30px"}},[s("div",{staticClass:"column",staticStyle:{"max-width":"450px"}},[s("form",{staticClass:"ui segment large form"},[s("div",{staticClass:"ui segment"},[s("div",{staticClass:"field"},[s("div",{staticClass:"ui left icon input large"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.email,expression:"email"}],attrs:{type:"text",placeholder:"Enter your email"},domProps:{value:t.email},on:{input:function(e){e.target.composing||(t.email=e.target.value)}}}),t._v(" "),s("i",{staticClass:"ui icon user"})])]),t._v(" "),s("div",{staticClass:"field"},[s("div",{staticClass:"ui left icon input large"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],attrs:{type:"password",placeholder:"Enter your password"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}}),t._v(" "),s("i",{staticClass:"ui icon key"})])]),t._v(" "),s("button",{staticClass:"ui button fluid large green",on:{click:t.signUpButtonPressed}},[t._v("Sign up")])])]),t._v(" "),s("router-link",{staticClass:"ui button basic",attrs:{to:{name:"Signin"},tag:"a"}},[t._v("Log in")])],1)])},staticRenderFns:[]},f=s("VU/8")(h,v,!1,null,null,null).exports,w={data:()=>({user:null,drivers:[],map:null}),async mounted(){l.a.auth().onAuthStateChanged(t=>{this.user=t}),this.map=new google.maps.Map(this.$refs.map,{zoom:10,center:new google.maps.LatLng(37.33446146,-122.04380955),mapTypeId:google.maps.MapTypeId.ROADMAP});const{docs:t}=await l.a.firestore().collection("users").where("active","==",!0).get(),e=[],s=[];for(let a=0;a<t.length;a++)e.push(new google.maps.Marker({map:this.map})),s.push(new google.maps.InfoWindow({disableAutoPan:!0}));l.a.firestore().collection("users").where("active","==",!0).onSnapshot(t=>{this.drivers=[];for(let i=0;i<t.docs.length;i++){var a=t.docs[i].data();this.drivers.push(a),e[i].setPosition(new google.maps.LatLng(a.lat,a.lng)),s[i].setContent(`<div class="ui header">${a.email} </div>`),s[i].open(this.map,e[i])}})},methods:{signOutButtonPressed(){l.a.auth().signOut().then(t=>{this.$router.push({name:"Signin"})}).catch(t=>{console.log(t.message)})}}},C={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"admin-view"},[e("h1",[this._v("Admin View")])])}]};var b=s("VU/8")(w,C,!1,function(t){s("dA4B")},null,null).exports;a.a.use(n.a);let P=new n.a({routes:[{path:"/driver",name:"Driver",component:d,meta:{requiresAuth:!0}},{path:"/signin",name:"Signin",component:g,meta:{guest:!0}},{path:"/signup",name:"SignUp",component:f,meta:{guest:!0}},{path:"/admin",name:"Admin",component:b,meta:{requiresAuth:!0}}]});P.beforeEach((t,e,s)=>{l.a.auth().onAuthStateChanged(a=>{!a&&t.matched.some(t=>t.meta.requiresAuth)?s({name:"Signin"}):a?(console.log("user",a),t.matched.some(t=>t.meta.guest)?s(e.fullPath):l.a.firestore().collection("roles").doc(a.uid).get().then(t=>{console.log("Snapshot",t),t.data().isAdmin?s({name:"Admin"}):s({name:"Driver"})})):s()}),s()});var y=P,A=s("yviF");a.a.config.productionTip=!1;A.initializeApp({apiKey:"AIzaSyBBdEb324AktMnZIZbLdI5WlJkz-vrUYFA",authDomain:"vue-locator-dashboard.firebaseapp.com",projectId:"vue-locator-dashboard",storageBucket:"vue-locator-dashboard.appspot.com",messagingSenderId:"783702401315",appId:"1:783702401315:web:26d9570adc0e585d852c96",measurementId:"G-60RDHMPYGK"}),new a.a({el:"#app",router:y,components:{App:o},template:"<App/>"})},NxZs:function(t,e){},dA4B:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.fcc86692b5fc2fdbfac6.js.map